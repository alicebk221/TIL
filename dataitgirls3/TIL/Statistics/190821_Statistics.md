
# Seaborn 라이브러리를 활용한 지난 시간 복습


```python
import seaborn
from numpy.random import binomial
```

#### 이항 분포


```python
 # 앞면이 나올 확률 .4인 동전 10개를 던졌을 때 실제로 앞면은 몇 개씩 나올까?
x = binomial(10, .4, 100)
```
* x축은 총 100번 중 각 구간의 숫자만큼 앞면이 나온 총합, y축은 확률
* bins = []로 구간 직접 설정 가능, bins는 히스토그램의 막대 갯수를 설정하는 것.
* 'bins = 5' 라고 입력하면 구간을 임의로 나눈 막대 5개가 그려지고,
* 'bins = [1, 2, 3, 4, 5]'라고 입력하면 5 이후의 값은 5의 그래프에 합쳐져서 같이 나온다.

```python
seaborn.distplot(x, bins=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
```

```python
seaborn.distplot(x, bins=5)
```

```python
seaborn.distplot(x, bins=[1, 2, 3, 4, 5])
```

## 실습
아래 각 분포로 데이터를 만들어서 seaborn.distplot으로 그래프 그려보기.

### 이산
- 기하 분포
- 음이항 분포
- 포아송 분포

### 연속
- 균등 분포
- 정규 분포
- 지수 분포


```python
from numpy.random import geometric, negative_binomial, exponential, multinomial, poisson, uniform, normal
```

#### 기하 분포


```python
# 성공률 30%, 성공할 때까지 걸린 횟수를 100회 구해보기
g = geometric(.3, 100)
seaborn.distplot(g)
```

#### 음이항 분포


```python
# 성공률 1%, 10번 달성할 때까지 걸리는 시간을 총 100회 구해보기
nb = negative_binomial(10, .1, 100)
seaborn.distplot(nb)
```

#### 포아송 분포


```python
# 평균 20회일 때 100일 동안 실행되는 횟수
p = poisson(20, 100)
seaborn.distplot(p)
```

#### 균등 분포


```python
# 1~10까지 숫자를 균등한 확률로 하나씩 뽑는 것을 총 50회 반복
u = uniform(1, 10, 50)
seaborn.distplot(u)
```

#### 정규 분포


```python
#고객이 평균 30만원(표준편차 10만원)을 쓸 때 각 고객이 쓰는 돈을 총 100회 구해보기
n = normal(30, 10, 100)
seaborn.distplot(n)
```

#### 지수 분포


```python
# 평균 10씩 걸리는 사건이 다음 사건이 일어날 때까지 걸리는 시간을 총 100회 반복
e = exponential(10, 100) 
seaborn.distplot(e)
```

## 과제 : 리트리버 분포
우리 리트리버는 10%의 확률로 짜증이 납니다. 이틀 연속으로 짜증이 나면 화를 냅니다. 리트리버가 화를 낼 때까지 기간을 시뮬레이션 해보세요.


```python
한계 = 2
옐로카드 = 0
짜증확률 = .1
기간 = 0

while 옐로카드 < 한계:
    짜증 = binomial(1, 짜증확률)
    if 짜증 == 1:
        옐로카드 += 1
    else:
        옐로카드 = 0
    기간 += 1
기간
```


```python
개판 = []
for i in range(100):
    한계 = 2
    옐로카드 = 0
    짜증확률 = .1
    기간 = 0
    
    while 옐로카드 < 한계:
        짜증 = binomial(1, 짜증확률)
        if 짜증 == 1:
            옐로카드 += 1
        else:
            옐로카드 = 0
        기간 += 1
    개판.append(기간)
seaborn.distplot(개판)
```

## 확률 분포
- 데이터를 만드는(만들어진) 방법

## 모수 (= Parameter)
- 일종의 설정값
- 데이터의 분포(데이터의 모양, 분포의 성격)를 결정하는 수치
- 각 분포를 구할 때 총 반복 횟수에 해당하는 숫자는 모수가 아니다. 확률에 영향을 주는 숫자가 아님.

## 데이터
- 분포에서 나온 것

# 집합
- 전체 집합
- 부분 집합
- 합집합
- 교집합

# 확률
- 확률 P(A) : 전체에서 A가 얼마나 되는가
- 결합 확률 P(A, B) : 전체 중 A와 B 모두를 충족하는 경우
- 조건부 확률 P(B|A) = P(A, B) / P(A) : A를 만족하는 사람들 중에서 B도 만족하는 경우. ex) 검은 옷 입은 사람 중에서 안경을 쓰고 있는 비율.
    - Q. 세관 직원의 실력은 무엇으로 판단할까?  
    - (1) P(잡았, 노양심) (2) P(노양심|잡았) (3) P(잡았|노양심)  
    - A. (2), 세관은 잡고 나서의 결과만 알 수 있기 때문에 (3)은 계산 자체가 불가능.

- 두 사건 A, B가 독립이면 P(A|B) = P(A) 이고 P(B|A) =P(B)

## 그래프 모형
- 각 집합이 다른 집합에 미치는 영향을 화살표 그림으로 나타낼 수 있다.
- 순환 고리가 생기면 안 된다.
- 서로 영향을 주고 받는 경우는 사실 따져보면 시점이 다르거나 변수가 여러 개일 수 있으므로 분리해서 한 방향으로만 가게 설정하기.
- 모델이 복잡할 수록 맞을 확률이 줄어드니 모델은 가급적 간단하게 만들기.
- 단일 사례는 각 요인들이 결과에 미치는 인과관계를 특정하기 어렵기 때문에 모형을 만들기에 적합하지 못 하다.

## Explaining Away
- 독립관계인 A, B가 모두 C에 영향을 줄 때, 간접적으로 A와 B 사이에 관계가 생긴다.

## 측정
- 불가능한 것 : 사랑, 지능 등 심리학에서 주로 다루는 지표
- 현실적으로 어려운 것 : 외모 등 물리적으로 크기가 없는 것

### 실습 코드


```python
# 연기력 : 연속, 매출 : 연속이므로 둘 다 정규 분포를 따른다고 가정.
연기력 = normal(50, 15, 100) # 평균 50, 표준편차 15인 배우 100명
seaborn.distplot(연기력)
```

```python
# 연기력과 매출을 이어주는 화살표 역할, 연기력이 평균에 영향을 주기 때문에 그 평균이 매출의 데이터 모양을 바꾸는 것.
평균매출 = 10 * 연기력 + 20000
```

```python
# 이미 평균매출에 100개의 값이 들어가있어서 따로 설정해주지 않아도 100개의 결과가 나온다
매출 = normal(평균매출, 1000) 
seaborn.distplot(매출)
```

```python
seaborn.jointplot(연기력, 매출)  
# 각각의 점은 개별 작품, x축은 연기력, y축은 매출
```
### 연기의 영향이 매출의 표준편차에 영향을 미치는 모형


```python
# 표준편차로 사용
연기의영향 = 1000 * 연기력 
매출 = normal(20000, 연기의영향)
seaborn.jointplot(연기력, 매출)
```
## 연기의 영향이 매출의 평균에 영향을 미치는 모형


```python
연기의영향 = 100 * 연기력 + 20000
매출 = normal(연기의영향, 800)
seaborn.jointplot(연기력, 매출)
```

## 로지스틱 선형 모형


```python
from scipy.special import expit
# 어떤 값을 넣어도 0~1 사이의 값을 출력
expit(10)
```

### 연기력 예시


```python
# expit를 쓰지 않으면 음의 값을 가지는 값이 있어 연산이 안 되는 경우가 있으므로 expit을 사용해 무조건 0~1의 값을 가지도록 함
연기의영향 = expit(0.5 * 연기력 - 25)
```

```python
주연상 = binomial(5, 연기의영향) # 5개의 영화제에서 연기의 영향을 받는 주연상을 받는 횟수

seaborn.jointplot(연기력, 주연상)
```


```python
주연상 = binomial(1, 연기의영향)
seaborn.jointplot(연기력, 주연상)
```

#### CASE 2


```python
실력 = normal(50, 15, 100)
실력의영향 = expit(0.5 * 실력 - 25) # 0.5는 변별력을 결정하는 역할을 한다고 볼 수 있음


합격 = binomial(1, 실력의영향)
seaborn.jointplot(실력, 합격)
```

#### CASE 3  
- 선형모형 : 이산형 -> 연속형


```python
공기청정기 = binomial(1, .6, 100)
청정기의영향 = 8 * 공기청정기 + 8
# 청정기가 안 돌아가는 경우 9, 작동하는 경우 16

공기질 = normal(청정기의영향, 30)
```


- 로지스틱 선형 모형 : 이산형 -> 이산형


```python
공기청정기 = binomial(1, .6, 100)
청정기의영향 = expit(2 * 공기청정기 - 1)
앨러지 = binomial(1, 청정기의영향)
```

아래의 if문과 같은 의미를 가지고 있다.


```python
if 공기청정기 == 1:
    청정기의영향 = 0.73
else:
    청정기의영향 = 0.26
```